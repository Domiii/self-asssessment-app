{
  "rules": {
    "dbState": {
      "current": {
        ".read": "auth !== null",
        ".write": "auth !== null && (root.child('users').child(auth.uid).child('isAdmin').val() == true)"
      }
    },

    "concepts": {
      ".indexOn": ["ownerId", "parentId"],
      ".read": "auth !== null",
      ".write": "auth !== null && (root.child('users').child(auth.uid).child('isAdmin').val() == true)"
    },
    "conceptChecks": {
      ".read": "auth !== null",
      ".write": "auth !== null && (root.child('users').child(auth.uid).child('isAdmin').val() == true)"
    },
    "conceptResponses": {      
      ".indexOn": ["uid", "conceptId", "uid_conceptId"],
      ".read": "auth !== null",

      "$responseDetailId" : {
        ".write": "auth !== null && ((root.child('users').child(auth.uid).child('isAdmin').val() == true) || (!newData.exists() && data.exists()  && data.child('uid').val() === auth.uid) || (newData.exists()  && !data.exists() && newData.child('uid').val() === auth.uid) ||(newData.exists()  && data.exists()  && data.child('uid').val() === newData.child('uid').val() && data.child('uid').val() === auth.uid))"
      }
    },
    "conceptCheckResponses": {
      ".indexOn": ["uid"],
      ".read": "auth !== null",
      
      "$responseId" : {
        ".write": "auth !== null && ((root.child('users').child(auth.uid).child('isAdmin').val() == true) || (!newData.exists() && data.exists()  && data.child('uid').val() === auth.uid) || (newData.exists()  && !data.exists() && newData.child('uid').val() === auth.uid) ||(newData.exists()  && data.exists()  && data.child('uid').val() === newData.child('uid').val() && newData.child('uid').val() === auth.uid))"
      }
    },
    "conceptCheckResponseDetails": {      
      ".indexOn": ["uid", "conceptId", "uid_conceptId"],
      ".read": "auth !== null",

      "$responseDetailId" : {
        ".write": "auth !== null && ((root.child('users').child(auth.uid).child('isAdmin').val() == true) || (!newData.exists() && data.exists()  && data.child('uid').val() === auth.uid) || (newData.exists()  && !data.exists() && newData.child('uid').val() === auth.uid) ||(newData.exists()  && data.exists()  && data.child('uid').val() === newData.child('uid').val() && data.child('uid').val() === auth.uid))"
      }
    },
    "notifications": {
      ".read": "auth !== null",
      
      "$notificationId" : {
        ".write": "auth !== null && !data.exists() && newData.exists() && newData.child('uid').val() === auth.uid"
      }
    },
    "users": {
      "$uid" : {
        ".read": "auth !== null",
        
        "isAdmin" : {
          ".write": "false"
        },
        "adminDisplayMode" : {
          ".write": "auth !== null && (root.child('users').child(auth.uid).child('isAdmin').val() == true)"
        },
        "data": {
          ".write": "auth !== null && (((root.child('users').child(auth.uid).child('isAdmin').val() == true)) || $uid === auth.uid)"
        },
        "prefs": {
          ".write": "auth !== null && (((root.child('users').child(auth.uid).child('isAdmin').val() == true)) || $uid === auth.uid)"
        }
      }
    }
  }
}